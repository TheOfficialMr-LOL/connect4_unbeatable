<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Connect 4 - Home</title>
  <link rel="icon" href="trademark.jpg" type="image/jpg" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    h1 {
      font-size: 36px;
      font-weight: 600;
      color: #19118c;
      text-align: center;
      margin-bottom: 10px;
    }

    p {
      font-size: 18px;
      font-weight: 400;
      color: #444;
      text-align: center;
      margin: 0 20px 30px;
      max-width: 600px;
    }

    .button-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
      align-items: center;
    }

    .home-button {
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 600;
      background-color: #19118c;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 12px 28px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      transition: background-color 0.3s ease, transform 0.2s ease;
      width: 240px;
    }

    .home-button:hover {
      background-color: #4468ab;
      transform: scale(1.05);
    }

    footer {
      margin-top: 60px;
      font-size: 20px;
      color: #777;
    }

    #copyright footer img {
        width: 20px;
        height: 20px;
        filter: invert(50%);
        transition: filter 0.3s ease;
    }

    #copyright footer img:hover {
        filter: invert(100%);
    }
    footer a:hover {color: white;}

	#onlineGameContainer {
		width: 100vw;
		height: 100vh;
		background-color: rgba(0, 0, 0, 0.253);
		position: fixed;
		z-index: 100;
		display: none;
		align-items: center;
		justify-content: center;
	}

	#sessionLink {
		width: 300px;
		height: 200px;
		background-color: aliceblue;
		border-radius: 10px;
		padding: 20px;
		box-shadow: 0 0 10px rgba(0,0,0,0.3);
		text-align: center;
		font-size: 18px;
		font-weight: 600;
		color: #19118c;
	}

	#sessionLink input[type="text"] {
		width: 80%;
		padding: 8px 10px;
		margin: 10px 0;
		font-size: 16px;
		border: 1.5px solid #19118c;
		border-radius: 5px;
		outline: none;
		box-sizing: border-box;
	}

	#errorMessage {display: none;}
  </style>
</head>

<body>
    <h1>Unbeatable connect 4 AI</h1>
    <p>Play against a near-unbeatable AI that's developed by Mr LOL</p>
    <p>The algorithm makes use of bitboards, dyanmic scoring, and the minimax algorithm</p>

    <div class="button-container">
        <button class="home-button" onclick="window.location.href='/computerAlgorithm.html'">Computer vs Player</button>
        <button class="home-button" onclick="window.location.href='/localGame.html'">Local Game</button>
        <button class="home-button" onclick="document.getElementById('onlineGameContainer').style.display = 'flex';">Online Multiplayer</button>
        <button class="home-button" onclick="window.location.href='https://en.wikipedia.org/wiki/Connect_Four'" target="_blank">Learn the Rules</button>
        <button class="home-button" onclick="window.location.href='/algorithm.html'" target="_blank">Learn the Algorithm</button>
    </div>

	<div id="onlineGameContainer">
		<div id="sessionLink">
			<p style="color: #19118c; font-weight: bold;">Generate session</p>
			<label for="usernameInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: #19118c; transform: translateX(-35px); font-size: 15px;">Enter your username:</label>
			<input type="text" id="usernameInput" placeholder="Username" style="transform: translateY(-10px);"/>
			<p id="errorMessage" style="color: red; font-size: 12px; margin: 0 0 8px 0; margin-top: -10px;">The username must not be empty</p>
			<button class="home-button" style="width: 200px; font-size: 15px; padding: 10px 0;" onclick="generate_link();" id="submitButton">Generate link</button>
		</div>
	</div>



    <footer>
        <div id="copyright">
        <a href="https://github.com/TheOfficialMr-LOL/connect4_unbeatable" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
            Â© 2025 Connect 4 AI Project &nbsp;|&nbsp;
            <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg" alt="GitHub" style="width: 40px; vertical-align: middle; height: 40px;" />
        </a>
		</div>
        <a href="https://discord.com/users/745301207043801129" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
            Contact me &nbsp;|&nbsp;
            <img src="https://cdn.jsdelivr.net/npm/simple-icons@9.21.0/icons/discord.svg" alt="discord" style="width: 40px; vertical-align: middle; height: 40px;" />
        </a>
    </footer>


</body>

<script>
function generate_link() {
	let username = document.getElementById("usernameInput").value;
	console.log(username);
	if (username.trim() !== "") {
		document.getElementById("errorMessage").style.display = "none";
		document.getElementById("submitButton").innerHTML = "Generating link..."

		//generate link
		send_session_request(username);
	}
	else {
		document.getElementById("errorMessage").style.display = "block";
	}

}

function send_session_request(username) {
  fetch(`/create?username=${encodeURIComponent(username)}`)
	.then(response => {
		if (!response.ok) throw new Error('Failed to create session');
		return response.json();
	})
	.then(data => {
		console.log('New game session created:', data);
		//store playerID locally for reconnects and tracking
    localStorage.setItem('playerID', data.playerID);
		localStorage.setItem('username', username);
		localStorage.setItem("lastGameID", data.gameID);
		window.location.href = data.joinUrl;
	})
	.catch(err => {
		console.error('Error creating game session:', err);

		//handle error
		document.getElementById("submitButton").innerHTML = "Generate link";
		document.getElementById("errorMessage").innerHTML = "Failed to generate session. Please try again.";
		document.getElementById("errorMessage").style.display = "block";
	});
}

</script>
</html>
